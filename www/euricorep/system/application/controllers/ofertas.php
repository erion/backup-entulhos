<?php    class Ofertas extends Controller {        function Ofertas() {            parent::Controller();            $this->load->model('oferta');            $this->data['titulo'] = $this->oferta->titulo;            $this->data['usuario_logado'] = $this->session->userdata('nome');            $this->data['tipo_usuario'] = $this->session->userdata('tipo');            verificar_permissao($this->session->userdata('tipo'),array('SAD','ADM'));            seleciona_menu($this,'oferta_menu');        }        function listar() {            $o = new Oferta();            if (!empty($_GET)) {                $o->filtrar();            } else {                $o->order_by('created_at desc');            }            $CI = &get_instance();            $por_pagina = $CI->config->item('pedidos_por_pagina');            $this->data['o'] = $o->get($por_pagina,$this->input->get('per_page'))->all;                        $c = new Cliente();            $this->data['clientes'] = $c->get_dropdown();            $this->data['jsatual'] = array('oferta_listar');            $this->load->library('pagination');            $this->pagination->initialize(config_pagination('ofertas_listar',$o->count(),'per_page'));            $this->view->load('oferta/listar',$this->data);        }        function cadastrar() {            $post = $this->input->post('oferta');            $this->data['jsatual'] = array('oferta_cadastrar');            $c = new Cliente();            $this->data['clientes'] = $c->get_dropdown();            if (empty($post)) {                $this->data['oferta'] = $o = new Oferta();                $this->view->load('oferta/form',$this->data);            } else {                $o = new Oferta($this->input->post('oferta'));                $o->usuario_id = $this->session->userdata('id');                $this->data['oferta'] = $o;                if ($o->save()) {                    redirect('ofertas/listar');                }                $this->view->load('oferta/form',$this->data);            }        }        function detalhes($id) {            $post = $this->input->post('oferta');            $this->data['jsatual'] = array('oferta_cadastrar');            $c = new Cliente();            $this->data['clientes'] = $c->get_dropdown();            if (empty($post)) {                $o = new Oferta();                $this->data['oferta'] = $o->get_by_id($id);                $this->view->load('oferta/form',$this->data);            } else {                $this->data['oferta'] = $o = new Oferta($this->input->post('oferta'));                $o->id = $id;                $o->usuario_id = $this->session->userdata('id');                if ($o->save()) {                    redirect('ofertas/listar');                }                $this->view->load('oferta/form',$this->data);            }        }        function excluir($id) {            $o = new Oferta();            $o->get_by_id($id)->delete();            redirect('ofertas/listar');        }    }?>